# Parse the coefficients from https://math.mit.edu/~drew/ClassicalModPolys.html 
# e.g. from 
# [3,0] 1
# [2,0] -162000
# [2,1] 1488
# [2,2] -1
# [1,0] 8748000000
# [1,1] 40773375
# [0,0] -157464000000000
# to X3 - X2Y2 + 1488X2Y - 162000X2 + 1488XY2+ 4077375XY + 8748000000X + Y3 - 162000Y2 + 8748000000Y -157464000000000. 

import math
import sys
import time
import numpy as np
#from scipy import linalg

def parsephi():
	NUM_ROW = 22
	infile = open("phi_j_5")
	coeff = []
	for i in xrange(0,NUM_ROW):
		it = infile.readline()
		print i, it
		s = it.replace("[","").replace("\n","").replace("]",",").split(',')
		v = []
		for e in s:
			v.append(int(e))
		coeff.append( v )
		if v[0] != v[1]:
			w = [ v[1], v[0], v[2] ]
			coeff.append( w )
	print len(coeff), coeff
			
	infile.close()

PHI2 = [[3, 0, 1], [0, 3, 1], [2, 0, -162000], [0, 2, -162000], [2, 1, 1488], [1, 2, 1488], [2, 2, -1], [1, 0, 8748000000], [0, 1, 8748000000], [1, 1, 40773375], [0, 0, -157464000000000]]
PHI3 = [[1, 0, 1855425871872000000000L], [0, 1, 1855425871872000000000L], [1, 1, -770845966336000000], [2, 0, 452984832000000], [0, 2, 452984832000000], [2, 1, 8900222976000], [1, 2, 8900222976000], [2, 2, 2587918086], [3, 0, 36864000], [0, 3, 36864000], [3, 1, -1069956], [1, 3, -1069956], [3, 2, 2232], [2, 3, 2232], [3, 3, -1], [4, 0, 1], [0, 4, 1]]
PHI4 = [[0, 0, 280949374722195372109640625000000000000L], [1, 0, -364936327796757658404375000000000000L], [0, 1, -364936327796757658404375000000000000L], [1, 1, -94266583063223403127324218750000L], [2, 0, 158010236947953767724187500000000L], [0, 2, 158010236947953767724187500000000L], [2, 1, 188656639464998455284287109375L], [1, 2, 188656639464998455284287109375L], [2, 2, 26402314839969410496000000L], [3, 0, -22805180351548032195000000000L], [0, 3, -22805180351548032195000000000L], [3, 1, 12519806366846423598750000L], [1, 3, 12519806366846423598750000L], [3, 2, -914362550706103200000L], [2, 3, -914362550706103200000L], [3, 3, 2729942049541120], [4, 0, 24125474716854750000L], [0, 4, 24125474716854750000L], [4, 1, 1194227244109980000], [1, 4, 1194227244109980000], [4, 2, 1425220456750080], [2, 4, 1425220456750080], [4, 3, 80967606480], [3, 4, 80967606480], [4, 4, 7440], [5, 0, -8507430000], [0, 5, -8507430000], [5, 1, 561444609], [1, 5, 561444609], [5, 2, -2533680], [2, 5, -2533680], [5, 3, 2976], [3, 5, 2976], [5, 4, -1], [4, 5, -1], [6, 0, 1], [0, 6, 1]]
PHI5 = [[0, 0, 141359947154721358697753474691071362751004672000L], [1, 0, 53274330803424425450420160273356509151232000L], [0, 1, 53274330803424425450420160273356509151232000L], [1, 1, -264073457076620596259715790247978782949376L], [2, 0, 6692500042627997708487149415015068467200L], [0, 2, 6692500042627997708487149415015068467200L], [2, 1, 36554736583949629295706472332656640000L], [1, 2, 36554736583949629295706472332656640000L], [2, 2, 5110941777552418083110765199360000L], [3, 0, 280244777828439527804321565297868800L], [0, 3, 280244777828439527804321565297868800L], [3, 1, -192457934618928299655108231168000L], [1, 3, -192457934618928299655108231168000L], [3, 2, 26898488858380731577417728000L], [2, 3, 26898488858380731577417728000L], [3, 3, -441206965512914835246100L], [4, 0, 1284733132841424456253440L], [0, 4, 1284733132841424456253440L], [4, 1, 128541798906828816384000L], [1, 4, 128541798906828816384000L], [4, 2, 383083609779811215375L], [2, 4, 383083609779811215375L], [4, 3, 107878928185336800], [3, 4, 107878928185336800], [4, 4, 1665999364600], [5, 0, 1963211489280], [0, 5, 1963211489280], [5, 1, -246683410950], [1, 5, -246683410950], [5, 2, 2028551200], [2, 5, 2028551200], [5, 3, -4550940], [3, 5, -4550940], [5, 4, 3720], [4, 5, 3720], [5, 5, -1], [6, 0, 1], [0, 6, 1]]
PHI6 = [[0, 0, 1046287792331595219061944529269663931895808000000000000000000000000000000000000L], [1, 0, -432420017318544783650797667042382494638080000000000000000000000000000000000L], [0, 1, -432420017318544783650797667042382494638080000000000000000000000000000000000L], [1, 1, -6166313335188319461501393705017646071159040000000000000000000000000000000L], [2, 0, 318636568755712104910451376876091087570944000000000000000000000000000000L], [0, 2, 318636568755712104910451376876091087570944000000000000000000000000000000L], [2, 1, 3400224272680267350859802844946934688670080000000000000000000000000000L], [1, 2, 3400224272680267350859802844946934688670080000000000000000000000000000L], [2, 2, 163526738403207225411310628914385850045702000000000000000000000000L], [3, 0, -78784000458724875494046297768822126766080000000000000000000000000000L], [0, 3, -78784000458724875494046297768822126766080000000000000000000000000000L], [3, 1, 1666369785986657289314749499939350832551680000000000000000000000000L], [1, 3, 1666369785986657289314749499939350832551680000000000000000000000000L], [3, 2, -4374177763874249224643552696807599594951350000000000000000000000L], [2, 3, -4374177763874249224643552696807599594951350000000000000000000000L], [3, 3, 5932245266109295838583345085860525746879343437500000000000000L], [4, 0, 27585029025617312796714850374073234296576000000000000000000000000L], [0, 4, 27585029025617312796714850374073234296576000000000000000000000000L], [4, 1, -707510881189413296215915032287874628007040000000000000000000000L], [1, 4, -707510881189413296215915032287874628007040000000000000000000000L], [4, 2, 2433710941276863401289448399264356621603994500000000000000000L], [2, 4, 2433710941276863401289448399264356621603994500000000000000000L], [4, 3, -2956712171206167789355673623428045144259717968750000000000L], [3, 4, -2956712171206167789355673623428045144259717968750000000000L], [4, 4, 1605947077319969660296362470445556806553468918212890625L], [5, 0, -3804977492718423485876516049782566118400000000000000000000000L], [0, 5, -3804977492718423485876516049782566118400000000000000000000000L], [5, 1, 42708709924450154900550352695860583976224000000000000000000L], [1, 5, 42708709924450154900550352695860583976224000000000000000000L], [5, 2, -236629837042569118482565349999489391710685000000000000000L], [2, 5, -236629837042569118482565349999489391710685000000000000000L], [5, 3, 445864348316739430233101094961910440649985703125000000L], [3, 5, 445864348316739430233101094961910440649985703125000000L], [5, 4, -311134535843611379111123673185810178326032500000000L], [4, 5, -311134535843611379111123673185810178326032500000000L], [5, 5, 73916801901950644351881363035981206178174250000L], [6, 0, 701371454716940040404797974285085155072000000000000000000L], [0, 6, 701371454716940040404797974285085155072000000000000000000L], [6, 1, -1562519533763357349996605949462215928240000000000000000L], [1, 6, -1562519533763357349996605949462215928240000000000000000L], [6, 2, -3239608297583257815220116582730664028528375000000000L], [2, 6, -3239608297583257815220116582730664028528375000000000L], [6, 3, 8272406802775616537970438525337767824028398437500L], [3, 6, 8272406802775616537970438525337767824028398437500L], [6, 4, -1453926877471849806893399302837075197204000000L], [4, 6, -1453926877471849806893399302837075197204000000L], [6, 5, -1378093317482377164236089492985350340880000L], [5, 6, -1378093317482377164236089492985350340880000L], [6, 6, -32090945684614270846121407306015752156L], [7, 0, -32762871963764067359259426421974769920000000000000000L], [0, 7, -32762871963764067359259426421974769920000000000000000L], [7, 1, 148400254142484032816933796581934970800000000000000L], [1, 7, 148400254142484032816933796581934970800000000000000L], [7, 2, -83745955158282283520179500895879935069375000000L], [2, 7, -83745955158282283520179500895879935069375000000L], [7, 3, 11740867875542844748730860307041376754000000L], [3, 7, 11740867875542844748730860307041376754000000L], [7, 4, -4186372454180757144088509621864812895000L], [4, 7, -4186372454180757144088509621864812895000L], [7, 5, 649766707718044227111671819822651808L], [5, 7, 649766707718044227111671819822651808L], [7, 6, -26443912396475901348534204684720L], [6, 7, -26443912396475901348534204684720L], [7, 7, 113651462665302479047132560L], [8, 0, 573241901257818560012803903569301488000000000000L], [0, 8, 573241901257818560012803903569301488000000000000L], [8, 1, 4651317448787336490589663311012905400000000000L], [1, 8, 4651317448787336490589663311012905400000000000L], [8, 2, 1450703432085435358105137905506419833343750L], [2, 8, 1450703432085435358105137905506419833343750L], [8, 3, 32110949830720236975102577813380675000L], [3, 8, 32110949830720236975102577813380675000L], [8, 4, 26704053247732785202072793022720L], [4, 8, 26704053247732785202072793022720L], [8, 5, 41795518395289086441977640L], [5, 8, 41795518395289086441977640L], [8, 6, -41794150835034123580656L], [6, 8, -41794150835034123580656L], [8, 7, -5094034186182686310], [7, 8, -5094034186182686310], [8, 8, -25512094964159], [9, 0, -3443855973739579167786917857326240000000000L], [0, 9, -3443855973739579167786917857326240000000000L], [9, 1, 2838124059058709451007396242822399000000L], [1, 9, 2838124059058709451007396242822399000000L], [9, 2, -591188558932690854867280753536880000L], [2, 9, -591188558932690854867280753536880000L], [9, 3, 26190183002406119746443553783680L], [3, 9, 26190183002406119746443553783680L], [9, 4, -113647757443645217294685600L], [4, 9, -113647757443645217294685600L], [9, 5, 5056092038186441316], [5, 9, 5056092038186441316], [9, 6, -25587161604], [6, 9, -25587161604], [9, 7, 18155340], [7, 9, 18155340], [9, 8, -6696], [8, 9, -6696], [9, 9, 1], [10, 0, 68414985806696954849736000000L], [0, 10, 68414985806696954849736000000L], [10, 1, 12090387178191164120132197500L], [1, 10, 12090387178191164120132197500L], [10, 2, 71613201503725451570700216L], [2, 10, 71613201503725451570700216L], [10, 3, 53263835122054576937535L], [3, 10, 53263835122054576937535L], [10, 4, 5150977218933696774], [4, 10, 5150977218933696774], [10, 5, 25512103267200], [5, 10, 25512103267200], [10, 6, 8184], [6, 10, 8184], [11, 0, -453039686280000], [0, 11, -453039686280000], [11, 1, 96687754014528], [1, 11, 96687754014528], [11, 2, -1304194222980], [2, 11, -1304194222980], [11, 3, 4850017536], [3, 11, 4850017536], [11, 4, -7121736], [4, 11, -7121736], [11, 5, 4464], [5, 11, 4464], [11, 6, -1], [6, 11, -1], [12, 0, 1], [0, 12, 1]]
PHI7 = [[1, 1, 1221349308261453750252370983314569119494710493184000000000000000000L], [2, 0, 1464765079488386840337633731737402825128271675392000000000000000000L], [0, 2, 1464765079488386840337633731737402825128271675392000000000000000000L], [2, 1, -838538082798149465723818021032241603179964268544000000000000000L], [1, 2, -838538082798149465723818021032241603179964268544000000000000000L], [2, 2, -46666007311089950798495647194817495401448341504000000000000L], [3, 0, 13483958224762213714698012883865296529472356352000000000000000L], [0, 3, 13483958224762213714698012883865296529472356352000000000000000L], [3, 1, -129686683986501811181602978946723823397619367936000000000000L], [1, 3, -129686683986501811181602978946723823397619367936000000000000L], [3, 2, 72269669689202948469186346100000679630099972096000000000L], [2, 3, 72269669689202948469186346100000679630099972096000000000L], [3, 3, -5397554444336630396660447092290576395211374592000000L], [4, 0, 41375720005635744770247248526572116368162816000000000000L], [0, 4, 41375720005635744770247248526572116368162816000000000000L], [4, 1, 553293497305121712634517214392820316998991872000000000L], [1, 4, 553293497305121712634517214392820316998991872000000000L], [4, 2, 308718989330868920558541707287296140145328128000000L], [2, 4, 308718989330868920558541707287296140145328128000000L], [4, 3, 17972351380696034759035751584170427941396480000L], [3, 4, 17972351380696034759035751584170427941396480000L], [4, 4, 88037255060655710247136461896264828390470L], [5, 0, 42320664241971721884753245384947305283584000000000L], [0, 5, 42320664241971721884753245384947305283584000000000L], [5, 1, -40689839325168186578698294668599003971584000000L], [1, 5, -40689839325168186578698294668599003971584000000L], [5, 2, 11269804827778129625111322263056523132928000L], [2, 5, 11269804827778129625111322263056523132928000L], [5, 3, -901645312135695263877115693740562092344L], [3, 5, -901645312135695263877115693740562092344L], [5, 4, 14066810691825882583305340438456800L], [4, 5, 14066810691825882583305340438456800L], [5, 5, -18300817137706889881369818348L], [6, 0, 3643255017844740441130401792000000L], [0, 6, 3643255017844740441130401792000000L], [6, 1, 1038063543615451121419229773824000L], [1, 6, 1038063543615451121419229773824000L], [6, 2, 10685207605419433304631062899228L], [2, 6, 10685207605419433304631062899228L], [6, 3, 16125487429368412743622133040L], [3, 6, 16125487429368412743622133040L], [6, 4, 4460942463213898353207432L], [4, 6, 4460942463213898353207432L], [6, 5, 177089350028475373552L], [5, 6, 177089350028475373552L], [6, 6, 312598931380281], [7, 0, 104545516658688000], [0, 7, 104545516658688000], [7, 1, -34993297342013192], [1, 7, -34993297342013192], [7, 2, 720168419610864], [2, 7, 720168419610864], [7, 3, -4079701128594], [3, 7, -4079701128594], [7, 4, 9437674400], [4, 7, 9437674400], [7, 5, -10246068], [5, 7, -10246068], [7, 6, 5208], [6, 7, 5208], [7, 7, -1], [8, 0, 1], [0, 8, 1]]
PHI8 = [[0, 0, -1259925064698459799223870370866254232997822186002533976842071309339735925197601318359375000000000000L], [1, 0, 2891839411497627131864081904337317750674739994298397567849174351077751159667968750000000000000000L], [0, 1, 2891839411497627131864081904337317750674739994298397567849174351077751159667968750000000000000000L], [1, 1, 2222592169609618219995787547134709357565266268801614503256744396071029424667358398437500000000L], [2, 0, -2157532429308712796753556204385361158814551813290465577110708455187618255615234375000000000000L], [0, 2, -2157532429308712796753556204385361158814551813290465577110708455187618255615234375000000000000L], [2, 1, 516308374803110838638659999405519338497474900982794222527833515514402508735656738281250000L], [1, 2, 516308374803110838638659999405519338497474900982794222527833515514402508735656738281250000L], [2, 2, 3725235359636503558942212079708664298764959135440105516280571956112558305263519287109375L], [3, 0, 480116556126375138152841619131574497402315665404209573819748022117980957031250000000000000L], [0, 3, 480116556126375138152841619131574497402315665404209573819748022117980957031250000000000000L], [3, 1, -1660321192693227574844848968729153843054260863533998508845902825802129745483398437500000L], [1, 3, -1660321192693227574844848968729153843054260863533998508845902825802129745483398437500000L], [3, 2, -180187867398017248979248512290476440437804697190448382078667604981986999511718750000L], [2, 3, -180187867398017248979248512290476440437804697190448382078667604981986999511718750000L], [3, 3, 514412843489863383885140208366393136625819618578482852539811297995693206787109375L], [4, 0, 31416454275234648874953631203995398210443714790314226515860018167282104492187500000000L], [0, 4, 31416454275234648874953631203995398210443714790314226515860018167282104492187500000000L], [4, 1, 197341821381144808428553462138368655657948148568332557867868947754838466644287109375L], [1, 4, 197341821381144808428553462138368655657948148568332557867868947754838466644287109375L], [4, 2, -171814306202718601104750178540188729369959951617634891819452256718750000000000000L], [2, 4, -171814306202718601104750178540188729369959951617634891819452256718750000000000000L], [4, 3, -485019607819528510708464720651503124596992222087849252905536671875000000000L], [3, 4, -485019607819528510708464720651503124596992222087849252905536671875000000000L], [4, 4, 18786759935602370938673325678523612553387264307397640563787520000000000000L], [5, 0, 595825152573532717681742774613562895021657059432138982517591082031250000000000000L], [0, 5, 595825152573532717681742774613562895021657059432138982517591082031250000000000000L], [5, 1, -6349751374971005289736100899431308044091500334628882902557771590820312500000000L], [1, 5, -6349751374971005289736100899431308044091500334628882902557771590820312500000000L], [5, 2, 12881110445570129309840247898262922529202613272198956897832531929687500000000L], [2, 5, 12881110445570129309840247898262922529202613272198956897832531929687500000000L], [5, 3, -7159361225727255099580660194139288935142034608202996654063769363281250000L], [3, 5, -7159361225727255099580660194139288935142034608202996654063769363281250000L], [5, 4, 586851812441362334135935858135253832185791776377575605392160000000000L], [4, 5, 586851812441362334135935858135253832185791776377575605392160000000000L], [5, 5, 179073003539689758693063089394235367959949410734680662874748000000L], [6, 0, 3247567518999520983872420401268621520947254617244800358391830078125000000000L], [0, 6, 3247567518999520983872420401268621520947254617244800358391830078125000000000L], [6, 1, 20755545175692883198705158943161836698838403748243809872370452636718750000L], [1, 6, 20755545175692883198705158943161836698838403748243809872370452636718750000L], [6, 2, -148184626587108044009926218600448232569326355806972766048207312500000000L], [2, 6, -148184626587108044009926218600448232569326355806972766048207312500000000L], [6, 3, 201484907087738092159596371591667667496060685697322410639311000000000L], [3, 6, 201484907087738092159596371591667667496060685697322410639311000000000L], [6, 4, -88012776667276058679280500784865763190778117829743003081664000000L], [4, 6, -88012776667276058679280500784865763190778117829743003081664000000L], [6, 5, 11217393453547600384708317483066492046225208605530019170816000L], [5, 6, 11217393453547600384708317483066492046225208605530019170816000L], [6, 6, -158810357931997071772627427499648092212547522281312839936L], [7, 0, -5790535436561105375522246013637387236262493061253916775093750000000000L], [0, 7, -5790535436561105375522246013637387236262493061253916775093750000000000L], [7, 1, 95169842605869243741101318338215633687626286235475625650062500000000L], [1, 7, 95169842605869243741101318338215633687626286235475625650062500000000L], [7, 2, -151638480005016062214845804965575910333934216555748242793281250000L], [2, 7, -151638480005016062214845804965575910333934216555748242793281250000L], [7, 3, -8748419285618665069826264533122984326821320361556770066500000L], [3, 7, -8748419285618665069826264533122984326821320361556770066500000L], [7, 4, 45558722660155460586046536161586100880704478742904799328000L], [4, 7, 45558722660155460586046536161586100880704478742904799328000L], [7, 5, 6326461442324163523315472945027012513915182432491720192L], [5, 7, 6326461442324163523315472945027012513915182432491720192L], [7, 6, 99062886301871418348536632217934601106741283319296L], [6, 7, 99062886301871418348536632217934601106741283319296L], [7, 7, 128832296974596434638347792832163581557703680L], [8, 0, 3047054822782089668624459078493314595043379945913102761718750000L], [0, 8, 3047054822782089668624459078493314595043379945913102761718750000L], [8, 1, 62455076971567640336206139739710791896041377577085845437500000L], [1, 8, 62455076971567640336206139739710791896041377577085845437500000L], [8, 2, 53932199568426798590055832950935931409868044087302336000000L], [2, 8, 53932199568426798590055832950935931409868044087302336000000L], [8, 3, 7343194937088187841588966452429375207832749588209432000L], [3, 8, 7343194937088187841588966452429375207832749588209432000L], [8, 4, -133546312118278441290258919004988971154285533306880L], [4, 8, -133546312118278441290258919004988971154285533306880L], [8, 5, 24939018056549353391282658184625378179180460544L], [5, 8, 24939018056549353391282658184625378179180460544L], [8, 6, -803725309258024030994698637263251353077248L], [6, 8, -803725309258024030994698637263251353077248L], [8, 7, 4745830567628632761856422904569076944L], [7, 8, 4745830567628632761856422904569076944L], [8, 8, -2041437039412434917208653134080L], [9, 0, -520067808058909220014353176629134712264772393194500000000L], [0, 9, -520067808058909220014353176629134712264772393194500000000L], [9, 1, 571459463835995161506183399545857463051290669929750000L], [1, 9, 571459463835995161506183399545857463051290669929750000L], [9, 2, -197521541942677134523793158505822047314560052072000L], [2, 9, -197521541942677134523793158505822047314560052072000L], [9, 3, 23623974295654813377158727217379732833898137345L], [3, 9, 23623974295654813377158727217379732833898137345L], [9, 4, -796676135899570817558402872509493997309184L], [4, 9, -796676135899570817558402872509493997309184L], [9, 5, 4743317837265062468423755822048356048L], [5, 9, 4743317837265062468423755822048356048L], [9, 6, -329632585376759146098794797312L], [6, 9, -329632585376759146098794797312L], [9, 7, 254280573881435286102744480L], [7, 9, 254280573881435286102744480L], [9, 8, 4723467116054155221168L], [8, 9, 4723467116054155221168L], [9, 9, 3211926994906879], [10, 0, 194011691774389784775766162623440250000L], [0, 10, 194011691774389784775766162623440250000L], [10, 1, 83443317610534187375785190080819514625L], [1, 10, 83443317610534187375785190080819514625L], [10, 2, 1365311867479274977245656739956703216L], [2, 10, 1365311867479274977245656739956703216L], [10, 3, 3608183328359975892089596589727744L], [3, 10, 3608183328359975892089596589727744L], [10, 4, 2099876382840529140905107362048L], [4, 10, 2099876382840529140905107362048L], [10, 5, 261310970398725793350382848L], [5, 10, 261310970398725793350382848L], [10, 6, 4728246427151406262992L], [6, 10, 4728246427151406262992L], [10, 7, 3211964917645312], [7, 10, 3211964917645312], [10, 8, -22932096], [8, 10, -22932096], [10, 9, 7440], [9, 10, 7440], [10, 10, -1], [11, 0, -24125403112135308000L], [0, 11, -24125403112135308000L], [11, 1, 11941355072680118832L], [1, 11, 11941355072680118832L], [11, 2, -355479814776346879], [2, 11, -355479814776346879], [11, 3, 2895840108006912], [3, 11, 2895840108006912], [11, 4, -9778267498800], [4, 11, -9778267498800], [11, 5, 16203352576], [5, 11, 16203352576], [11, 6, -13923936], [6, 11, -13923936], [11, 7, 5952], [7, 11, 5952], [11, 8, -1], [8, 11, -1], [12, 0, 1], [0, 12, 1]]
PHI9 = [[0, 0, 69044898341264155384039982812013450021641280641122350612180014989312000000000000000000000000000000000000L], [1, 0, -232683783909812135091180664408097870003379370875184432208292127703040000000000000000000000000000000000L], [0, 1, -232683783909812135091180664408097870003379370875184432208292127703040000000000000000000000000000000000L], [1, 1, -750477769359323701346534735710985354748615023238392518722583107993600000000000000000000000000000000L], [2, 0, 376501703401756663167829622430300312634214504891079031582441139601408000000000000000000000000000000L], [0, 2, 376501703401756663167829622430300312634214504891079031582441139601408000000000000000000000000000000L], [2, 1, 2180180133682453618437602678049589323532982602942504524433011926630400000000000000000000000000000L], [1, 2, 2180180133682453618437602678049589323532982602942504524433011926630400000000000000000000000000000L], [2, 2, -195104180586505976656170267263663673342537332095867469769673831088128000000000000000000000000L], [3, 0, -356498882808745744675952813139106931526561504326407178437871617966080000000000000000000000000000L], [0, 3, -356498882808745744675952813139106931526561504326407178437871617966080000000000000000000000000000L], [3, 1, -734745143710253598299658819584221973541388698584653375578080857292800000000000000000000000000L], [1, 3, -734745143710253598299658819584221973541388698584653375578080857292800000000000000000000000000L], [3, 2, -2174126850109403409612089909266604830941666101520869114646967552573440000000000000000000000L], [2, 3, -2174126850109403409612089909266604830941666101520869114646967552573440000000000000000000000L], [3, 3, 1337407428761009589661412615877939747792960714552280876322431791267840000000000000000000L], [4, 0, 209224067686996826205300712689558941749016250509807218578387753762816000000000000000000000000L], [0, 4, 209224067686996826205300712689558941749016250509807218578387753762816000000000000000000000000L], [4, 1, -552474127304059622933147654782708735487934827715739874235214567833600000000000000000000000L], [1, 4, -552474127304059622933147654782708735487934827715739874235214567833600000000000000000000000L], [4, 2, 1072273000502181967970881238481789529001284473312660386993634558345216000000000000000000L], [2, 4, 1072273000502181967970881238481789529001284473312660386993634558345216000000000000000000L], [4, 3, -66711604798252702203240814195082538435645647967276610575498938941440000000000000000L], [3, 4, -66711604798252702203240814195082538435645647967276610575498938941440000000000000000L], [4, 4, -18479552284868738690246708627837190388988153031268327611159810146304000000000000L], [5, 0, -71846975897804771463705349756964908464196982078331911573168361308160000000000000000000000L], [0, 5, -71846975897804771463705349756964908464196982078331911573168361308160000000000000000000000L], [5, 1, 243396300874543727943730913944913649785290815733841200853312530808832000000000000000000L], [1, 5, 243396300874543727943730913944913649785290815733841200853312530808832000000000000000000L], [5, 2, -59901709382329805978633635413667280365706226187233481397070735605760000000000000000L], [2, 5, -59901709382329805978633635413667280365706226187233481397070735605760000000000000000L], [5, 3, -18835180011463843231694024714228261766240954982932133312407483187200000000000000L], [3, 5, -18835180011463843231694024714228261766240954982932133312407483187200000000000000L], [5, 4, 658003637405245442250095582476112855345312171647903310493473832960000000000L], [4, 5, 658003637405245442250095582476112855345312171647903310493473832960000000000L], [5, 5, 81733165849983664671370721136696538031126996011599298838686334976000000L], [6, 0, 11840440831010017485683642912266874224079473751966006057244794290176000000000000000000L], [0, 6, 11840440831010017485683642912266874224079473751966006057244794290176000000000000000000L], [6, 1, -9317132816976477132813130144500667240517074482239080939579936604160000000000000000L], [1, 6, -9317132816976477132813130144500667240517074482239080939579936604160000000000000000L], [6, 2, 715289164764285891371697249337632347917412105898043988469312651264000000000000L], [2, 6, 715289164764285891371697249337632347917412105898043988469312651264000000000000L], [6, 3, 510602989311796036944510442921534158938486209261514004104006860800000000000L], [3, 6, 510602989311796036944510442921534158938486209261514004104006860800000000000L], [6, 4, 99649379447299227710013261724885046276640125416907777760194199552000000L], [4, 6, 99649379447299227710013261724885046276640125416907777760194199552000000L], [6, 5, 1287403158247585064152497034973072570105141673574412698991984640000L], [5, 6, 1287403158247585064152497034973072570105141673574412698991984640000L], [6, 6, -2003361981538502515786431353709655012603350293310522697051236L], [7, 0, 2893588694944278522177764102620581575000495540984238180610867200000000000000000L], [0, 7, 2893588694944278522177764102620581575000495540984238180610867200000000000000000L], [7, 1, -60495652821744993287486932849986202311614543306205957452432670720000000000000L], [1, 7, -60495652821744993287486932849986202311614543306205957452432670720000000000000L], [7, 2, 64735274511100762564459248803228674900735227692774967911928299520000000000L], [2, 7, 64735274511100762564459248803228674900735227692774967911928299520000000000L], [7, 3, -16474618115158934218802257796780294354859440459742602945869381632000000L], [3, 7, -16474618115158934218802257796780294354859440459742602945869381632000000L], [7, 4, 642148740736630948004496052690013708092074404011516770532392960000L], [4, 7, 642148740736630948004496052690013708092074404011516770532392960000L], [7, 5, -2064039409580538723682303423606644781559896017127825973607192L], [5, 7, -2064039409580538723682303423606644781559896017127825973607192L], [7, 6, 589799947861930821558414471517379624168655297448978560L], [6, 7, 589799947861930821558414471517379624168655297448978560L], [7, 7, 114208634776799415892612599617569985637849232080L], [8, 0, 235558341987396949911428581593686239877979341954146161917952000000000000L], [0, 8, 235558341987396949911428581593686239877979341954146161917952000000000000L], [8, 1, 6546983950323272622474592016942583982874006866244655026012160000000000L], [1, 8, 6546983950323272622474592016942583982874006866244655026012160000000000L], [8, 2, 8776475257933895754391596525840222413136747280735390811553792000000L], [2, 8, 8776475257933895754391596525840222413136747280735390811553792000000L], [8, 3, 1773899530331128588088312119839752844385302827595855128985600000L], [3, 8, 1773899530331128588088312119839752844385302827595855128985600000L], [8, 4, 61334584124724430829107139003055411562736252229635281920495L], [4, 8, 61334584124724430829107139003055411562736252229635281920495L], [8, 5, 295043918779312988862524085979914335281706535935143680L], [5, 8, 295043918779312988862524085979914335281706535935143680L], [8, 6, 114663187991652512877947591740259351959099261248L], [6, 8, 114663187991652512877947591740259351959099261248L], [8, 7, 2196008982690079369308616861054207114320L], [7, 8, 2196008982690079369308616861054207114320L], [8, 8, -169084890908576041794892443742536L], [9, 0, 6390980147531295015493344616502870354075036858198261760000000000L], [0, 9, 6390980147531295015493344616502870354075036858198261760000000000L], [9, 1, -7900333936192849023918427261965278932265209355223171072000000L], [1, 9, -7900333936192849023918427261965278932265209355223171072000000L], [9, 2, 3273266810212629480595452963053694318464393523934986240000L], [2, 9, 3273266810212629480595452963053694318464393523934986240000L], [9, 3, -527782836316123418691170962447078429119508813357952220L], [3, 9, -527782836316123418691170962447078429119508813357952220L], [9, 4, 29938980095729674278837381908388909886666835116800L], [4, 9, 29938980095729674278837381908388909886666835116800L], [9, 5, -452102708759835815999184660653014461675230688L], [5, 9, -452102708759835815999184660653014461675230688L], [9, 6, 1097815847178520649575574301039075207792L], [6, 9, 1097815847178520649575574301039075207792L], [9, 7, -169096306433121398819742262191810L], [7, 9, -169096306433121398819742262191810L], [9, 8, 205874310760628521421376L], [8, 9, 205874310760628521421376L], [9, 9, 28587961955951784], [10, 0, 10331567886902497628770879898357071872000000L], [0, 10, 10331567886902497628770879898357071872000000L], [10, 1, 6381231899147017430314467070087302021120000L], [1, 10, 6381231899147017430314467070087302021120000L], [10, 2, 155705417634012907024266501589913689446466L], [2, 10, 155705417634012907024266501589913689446466L], [10, 3, 655424730501203626951599797646911785920L], [3, 10, 655424730501203626951599797646911785920L], [10, 4, 680444811295518681180723971143182528L], [4, 10, 680444811295518681180723971143182528L], [10, 5, 186204831778242651626938540276560L], [5, 10, 186204831778242651626938540276560L], [10, 6, 11645320898401795868144158404L], [6, 10, 11645320898401795868144158404L], [10, 7, 102969059545961636573088L], [7, 10, 102969059545961636573088L], [10, 8, 28587961990122552], [8, 10, 28587961990122552], [10, 9, 15624], [9, 10, 15624], [10, 10, -1], [11, 0, 5567288717204029440000L], [0, 11, 5567288717204029440000L], [11, 1, -3894864835363363281932L], [1, 11, -3894864835363363281932L], [11, 2, 160958016085240175040L], [2, 11, 160958016085240175040L], [11, 3, -1807128632206069128], [3, 11, -1807128632206069128], [11, 4, 8462621974879728], [4, 11, 8462621974879728], [11, 5, -19911358807902], [5, 11, -19911358807902], [11, 6, 25558882848], [6, 11, 25558882848], [11, 7, -18155340], [7, 11, -18155340], [11, 8, 6696], [8, 11, 6696], [11, 9, -1], [9, 11, -1], [12, 0, 1], [0, 12, 1]]
PHI = [ [], [], PHI2, PHI3, PHI4, PHI5, PHI6, PHI7, PHI8, PHI9  ]

def Phieval(N, i, j, m):
    """ eval PHI_N(i,j) mod m  """
    v = 0
    for monomial in PHI[N]:
        v = ( v + (i**monomial[0]) * (j**monomial[1]) * (monomial[2]%m)  )%m
    return v

def onesidephi(N, i, m):
    """ input, N, i, m, output the coefficients of the polynomial f(y) = PHI_N(i,y)  """
    v = []
    for monomial in PHI[N]:
        v.append( [ ( (i**monomial[0]) * (monomial[2]%m)  )%m, monomial[1] ] )
    return v

print Phieval(3, 23, 29, 83)
print onesidephi(3, 23, 83)
#parsephi()
